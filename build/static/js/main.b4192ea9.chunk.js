(this["webpackJsonpdynamic-form-builder"]=this["webpackJsonpdynamic-form-builder"]||[]).push([[0],{144:function(e,t,a){"use strict";a.r(t);var c=a(0),l=a.n(c),r=a(36),n=a.n(r),i=a(74),s=a(20),o=a(14),d=a(213),j=a(225),b=a(67),u=a(212),h=a(226),O=a(214),x=a(216),v=a(219),m=a(221),p=a(230),g=a(222),f=a(232),y=a(215),k=a(208),C=a(224),w=a(233),A=a(209),F=a(234),S=a(235),I=a(218),D=a(113),L=a(2);const M=e=>Object(L.jsx)(D.a,Object(o.a)(Object(o.a)({},e),{},{children:Object(L.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})}));var E=()=>{const[e,t]=Object(c.useState)([]),[a,l]=Object(c.useState)("text"),[r,n]=Object(c.useState)(""),[i,s]=Object(c.useState)(!1),[D,E]=Object(c.useState)(!1),[T,B]=Object(c.useState)({}),N=Object(c.useCallback)((e,t)=>{try{const a=Object(o.a)({},t),c={Date:Date,Math:Math,parseInt:parseInt,parseFloat:parseFloat,calculateAge:e=>{if(!e)return 0;const t=new Date,a=new Date(e);if(isNaN(a.getTime()))return 0;let c=t.getFullYear()-a.getFullYear();const l=t.getMonth()-a.getMonth();return(l<0||0===l&&t.getDate()<a.getDate())&&c--,c}},l=Object(o.a)(Object(o.a)({},a),c),r=Object.keys(l),n=Object.values(l);return new Function(...r,'"use strict"; return ('.concat(e,");"))(...n)}catch(a){return console.error("Formula evaluation error:",a,"Formula:",e,"Context:",t),"Error"}},[]),W=Object(c.useCallback)(t=>{const a=Object(o.a)({},t);let c=!1;e.forEach(l=>{if(l.derived&&l.parentFields&&l.formula){const r={};let n=!0;if(l.parentFields.forEach(a=>{const c=e.find(e=>e.id===a);c&&a in t?r[c.label.toLowerCase().replace(/\s+/g,"_")]=t[a]:n=!1}),n){const e=N(l.formula,r);a[l.id]!==e&&(a[l.id]=e,c=!0)}}}),c&&B(a)},[e,N]),z=(e,a)=>{t(t=>t.map(t=>t.id===e?Object(o.a)(Object(o.a)({},t),a):t))},P=(e,t)=>{const a=Object(o.a)(Object(o.a)({},T),{},{[e]:t});B(a),W(a)};return Object(L.jsxs)(j.a,{p:3,children:[Object(L.jsx)(b.a,{variant:"h4",gutterBottom:!0,children:"Create Dynamic Form"}),Object(L.jsxs)(j.a,{display:"flex",gap:2,alignItems:"center",mb:3,children:[Object(L.jsxs)(u.a,{value:a,onChange:e=>l(e.target.value),children:[Object(L.jsx)(h.a,{value:"text",children:"Text"}),Object(L.jsx)(h.a,{value:"number",children:"Number"}),Object(L.jsx)(h.a,{value:"textarea",children:"Textarea"}),Object(L.jsx)(h.a,{value:"select",children:"Select"}),Object(L.jsx)(h.a,{value:"radio",children:"Radio"}),Object(L.jsx)(h.a,{value:"checkbox",children:"Checkbox"}),Object(L.jsx)(h.a,{value:"date",children:"Date"})]}),Object(L.jsx)(m.a,{variant:"contained",onClick:()=>{const e={id:Object(I.a)(),type:a,label:"",validation:{required:!1},options:"select"===a?[]:void 0};["select","radio","checkbox"].includes(a)&&(e.options=["Option 1","Option 2"]),t(t=>[...t,e])},children:"Add Field"}),e.length>0&&Object(L.jsx)(m.a,{variant:"outlined",onClick:()=>E(!D),children:D?"Hide Preview":"Show Preview"})]}),Object(L.jsxs)(j.a,{display:"flex",gap:3,children:[Object(L.jsxs)(j.a,{flex:D?1:2,children:[Object(L.jsx)(b.a,{variant:"h6",gutterBottom:!0,children:"Form Builder"}),Object(L.jsx)(p.a,{children:e.map((a,c)=>{var l,r,n;return Object(L.jsxs)(j.a,{mb:3,children:[Object(L.jsx)(g.a,{children:Object(L.jsxs)(j.a,{width:"100%",children:[Object(L.jsxs)(j.a,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,children:[Object(L.jsxs)(b.a,{variant:"h6",children:["Field #",c+1," - ",a.type]}),Object(L.jsx)(f.a,{onClick:()=>{return e=a.id,t(t=>t.filter(t=>t.id!==e)),void B(t=>{const a=Object(o.a)({},t);return delete a[e],a});var e},children:Object(L.jsx)(M,{})})]}),Object(L.jsx)(d.a,{fullWidth:!0,label:"Label",value:a.label,onChange:e=>z(a.id,{label:e.target.value}),margin:"normal"}),!a.derived&&Object(L.jsx)(d.a,{fullWidth:!0,label:"Default Value",value:null!==(l=a.defaultValue)&&void 0!==l?l:"",onChange:e=>z(a.id,{defaultValue:e.target.value}),margin:"normal"}),Object(L.jsx)(O.a,{control:Object(L.jsx)(v.a,{checked:a.validation.required,onChange:e=>z(a.id,{validation:Object(o.a)(Object(o.a)({},a.validation),{},{required:e.target.checked})})}),label:"Required"}),"text"===a.type||"textarea"===a.type?Object(L.jsxs)(j.a,{children:[Object(L.jsx)(d.a,{type:"number",label:"Min Length",value:a.validation.minLength||"",onChange:e=>z(a.id,{validation:Object(o.a)(Object(o.a)({},a.validation),{},{minLength:Number(e.target.value)})}),margin:"normal",size:"small",sx:{mr:2}}),Object(L.jsx)(d.a,{type:"number",label:"Max Length",value:a.validation.maxLength||"",onChange:e=>z(a.id,{validation:Object(o.a)(Object(o.a)({},a.validation),{},{maxLength:Number(e.target.value)})}),margin:"normal",size:"small"}),Object(L.jsxs)(j.a,{children:[Object(L.jsx)(O.a,{control:Object(L.jsx)(v.a,{checked:a.validation.email||!1,onChange:e=>z(a.id,{validation:Object(o.a)(Object(o.a)({},a.validation),{},{email:e.target.checked})})}),label:"Email Format"}),Object(L.jsx)(O.a,{control:Object(L.jsx)(v.a,{checked:a.validation.password||!1,onChange:e=>z(a.id,{validation:Object(o.a)(Object(o.a)({},a.validation),{},{password:e.target.checked})})}),label:"Password Rule"})]})]}):null,Object(L.jsx)(O.a,{control:Object(L.jsx)(v.a,{checked:a.derived||!1,onChange:e=>z(a.id,{derived:e.target.checked})}),label:"Is Derived Field?"}),a.derived&&Object(L.jsxs)(j.a,{children:[Object(L.jsx)(b.a,{variant:"subtitle2",gutterBottom:!0,children:"Parent Fields:"}),(n=a.id,e.filter(e=>e.id!==n&&!e.derived&&""!==e.label.trim())).map(e=>{var t;return Object(L.jsx)(O.a,{control:Object(L.jsx)(v.a,{checked:(null===(t=a.parentFields)||void 0===t?void 0:t.includes(e.id))||!1,onChange:t=>{const c=a.parentFields||[],l=t.target.checked?[...c,e.id]:c.filter(t=>t!==e.id);z(a.id,{parentFields:l})}}),label:"".concat(e.label," (").concat(e.type,")")},e.id)}),Object(L.jsx)(d.a,{fullWidth:!0,label:"Formula / Logic",value:a.formula||"",onChange:e=>z(a.id,{formula:e.target.value}),margin:"normal",helperText:"Use field labels in lowercase with underscores (e.g., calculateAge(date_of_birth))"}),a.parentFields&&a.parentFields.length>0&&a.formula&&Object(L.jsxs)(y.a,{severity:"info",sx:{mt:1},children:["Available variables: ",a.parentFields.map(t=>{const a=e.find(e=>e.id===t);return null===a||void 0===a?void 0:a.label.toLowerCase().replace(/\s+/g,"_")}).join(", ")]})]}),("select"===a.type||"radio"===a.type||"checkbox"===a.type)&&!a.derived&&Object(L.jsxs)(j.a,{mb:2,children:[Object(L.jsx)(b.a,{variant:"subtitle1",children:"Options"}),null===(r=a.options)||void 0===r?void 0:r.map((e,t)=>Object(L.jsxs)(j.a,{display:"flex",alignItems:"center",mb:1,gap:1,children:[Object(L.jsx)(d.a,{label:"Option ".concat(t+1),value:e,onChange:e=>{var c;const l=[...null!==(c=a.options)&&void 0!==c?c:[]];l[t]=e.target.value,z(a.id,{options:l})},size:"small"}),a.options&&a.options.length>2&&Object(L.jsx)(f.a,{size:"small",onClick:()=>{const e=a.options.filter((e,a)=>a!==t);z(a.id,{options:e})},children:Object(L.jsx)(M,{fontSize:"small"})}),Object(L.jsx)(O.a,{control:"checkbox"===a.type?Object(L.jsx)(v.a,{checked:!!Array.isArray(a.validation.correctAnswers)&&a.validation.correctAnswers.includes(e),onChange:t=>{let c=Array.isArray(a.validation.correctAnswers)?[...a.validation.correctAnswers]:[];t.target.checked?c.push(e):c=c.filter(t=>t!==e),z(a.id,{validation:Object(o.a)(Object(o.a)({},a.validation),{},{correctAnswers:c})})}}):Object(L.jsx)(x.a,{checked:a.validation.correctAnswer===e,onChange:()=>z(a.id,{validation:Object(o.a)(Object(o.a)({},a.validation),{},{correctAnswer:e})})}),label:"Correct"})]},t)),Object(L.jsx)(m.a,{variant:"outlined",size:"small",onClick:()=>{var e;const t=[...null!==(e=a.options)&&void 0!==e?e:[],"Option ".concat(a.options.length+1)];z(a.id,{options:t})},children:"Add Option"})]})]})}),Object(L.jsx)(k.a,{})]},a.id)})})]}),D&&e.length>0&&Object(L.jsx)(j.a,{flex:1,children:Object(L.jsxs)(C.a,{elevation:2,sx:{p:3},children:[Object(L.jsx)(b.a,{variant:"h6",gutterBottom:!0,children:"Live Preview"}),Object(L.jsxs)(j.a,{children:[e.map(e=>e.label?(e=>{var t,a,c,l;const r=null!==(t=T[e.id])&&void 0!==t?t:"checkbox"===e.type?[]:"";if(e.derived)return Object(L.jsx)(d.a,{fullWidth:!0,label:"".concat(e.label," (Auto-calculated)"),value:r,disabled:!0,margin:"normal",sx:{"& .MuiInputBase-input":{color:"text.secondary"}}},e.id);switch(e.type){case"text":case"number":case"date":return Object(L.jsx)(d.a,{type:e.type,fullWidth:!0,label:e.label,value:r,onChange:t=>P(e.id,t.target.value),margin:"normal"},e.id);case"textarea":return Object(L.jsx)(d.a,{fullWidth:!0,label:e.label,value:r,onChange:t=>P(e.id,t.target.value),multiline:!0,rows:3,margin:"normal"},e.id);case"select":return Object(L.jsxs)(j.a,{mb:2,children:[Object(L.jsx)(b.a,{children:e.label}),Object(L.jsx)(u.a,{fullWidth:!0,value:r,onChange:t=>P(e.id,t.target.value),children:null===(a=e.options)||void 0===a?void 0:a.map((e,t)=>Object(L.jsx)(h.a,{value:e,children:e},t))})]},e.id);case"radio":return Object(L.jsxs)(j.a,{mb:2,children:[Object(L.jsx)(b.a,{children:e.label}),null===(c=e.options)||void 0===c?void 0:c.map((t,a)=>Object(L.jsx)(O.a,{value:t,control:Object(L.jsx)(x.a,{checked:r===t,onChange:()=>P(e.id,t)}),label:t},a))]},e.id);case"checkbox":return Object(L.jsxs)(j.a,{mb:2,children:[Object(L.jsx)(b.a,{children:e.label}),null===(l=e.options)||void 0===l?void 0:l.map((t,a)=>Object(L.jsx)(O.a,{control:Object(L.jsx)(v.a,{checked:Array.isArray(r)&&r.includes(t),onChange:a=>{const c=Array.isArray(r)?r:[],l=a.target.checked?[...c,t]:c.filter(e=>e!==t);P(e.id,l)}}),label:t},a))]},e.id);default:return null}})(e):null),e.some(e=>e.derived)&&Object(L.jsx)(y.a,{severity:"info",sx:{mt:2},children:"Derived fields will auto-update as you change parent fields above."})]})]})})]}),Object(L.jsx)(j.a,{mt:3,children:Object(L.jsx)(m.a,{variant:"contained",color:"primary",onClick:()=>s(!0),disabled:0===e.length,children:"Save Form"})}),Object(L.jsxs)(w.a,{open:i,onClose:()=>s(!1),children:[Object(L.jsx)(A.a,{children:"Save Form"}),Object(L.jsx)(F.a,{children:Object(L.jsx)(d.a,{fullWidth:!0,label:"Form Name",value:r,onChange:e=>n(e.target.value),margin:"normal"})}),Object(L.jsxs)(S.a,{children:[Object(L.jsx)(m.a,{onClick:()=>s(!1),children:"Cancel"}),Object(L.jsx)(m.a,{onClick:()=>{const a={name:r,fields:e,createdAt:(new Date).toISOString()};localStorage.setItem("form_".concat(r),JSON.stringify(a)),s(!1),alert("Form saved successfully!"),t([]),n(""),B({})},variant:"contained",color:"primary",disabled:!r,children:"Save"})]})]})]})},T=a(231),B=a(220);var N=()=>{const[e,t]=Object(c.useState)(null),[a,l]=Object(c.useState)({}),[r,n]=Object(c.useState)({}),[i,p]=Object(c.useState)(!1),[g,f]=Object(c.useState)(null),{formId:k}=Object(s.h)();Object(c.useEffect)(()=>{if(!k)return;const e=localStorage.getItem(k);if(e){const a=JSON.parse(e);t(a);const c={};a.fields.forEach(e=>{e.derived||(c[e.id]=e.defaultValue||("checkbox"===e.type?[]:""))}),l(c)}},[k]);const C=Object(c.useCallback)((e,t)=>{try{let a=Object.values(t);if(a.some(e=>""===e||void 0===e||null===e))return"";const c=Object(o.a)({},t),l={Date:Date,Math:Math,parseInt:parseInt,parseFloat:parseFloat,calculateAge:e=>{if(!e)return 0;const t=new Date,a=new Date(e);if(isNaN(a.getTime()))return 0;let c=t.getFullYear()-a.getFullYear();const l=t.getMonth()-a.getMonth();return(l<0||0===l&&t.getDate()<a.getDate())&&c--,c}},r=Object(o.a)(Object(o.a)({},c),l),n=Object.keys(r);a=Object.values(r);return new Function(...n,'"use strict"; return ('.concat(e,");"))(...a)}catch(a){return console.error("Formula evaluation error:",a,"Formula:",e,"Context:",t),"Error"}},[]),w=Object(c.useCallback)(t=>{if(!e)return t;const a=Object(o.a)({},t);let c=!1;return e.fields.forEach(l=>{if(l.derived&&l.parentFields&&l.formula){const r={};let n=!0;if(l.parentFields.forEach(a=>{const c=e.fields.find(e=>e.id===a);if(c&&a in t){const e=c.label.toLowerCase().replace(/\s+/g,"_");r[e]=t[a]}else n=!1}),n){const e=C(l.formula,r);a[l.id]!==e&&(a[l.id]=e,c=!0)}else l.id in a&&(delete a[l.id],c=!0)}}),c?a:t},[e,C]);Object(c.useEffect)(()=>{if(!e||0===Object.keys(a).length)return;const t=w(a);t!==a&&l(t)},[e,a,w]);const A=Object(c.useCallback)((e,t)=>{const{validation:a}=e;if(a.required&&(!t||Array.isArray(t)&&0===t.length))return"This field is required.";if("string"===typeof t){if(a.minLength&&t.length<a.minLength)return"Minimum length is ".concat(a.minLength);if(a.maxLength&&t.length>a.maxLength)return"Maximum length is ".concat(a.maxLength);if(a.email&&t&&!/^\S+@\S+\.\S+$/.test(t))return"Invalid email format.";if(a.password&&t&&(!/^.{8,}$/.test(t)||!/\d/.test(t)))return"Password must be at least 8 characters and contain a number."}return""},[]),F=Object(c.useCallback)((t,c)=>{const r=Object(o.a)(Object(o.a)({},a),{},{[t]:c}),i=w(r);l(i);const s=null===e||void 0===e?void 0:e.fields.find(e=>e.id===t);if(s&&!s.derived){const e=A(s,c);n(a=>Object(o.a)(Object(o.a)({},a),{},{[t]:e}))}},[a,w,e,A]);return e?Object(L.jsxs)(j.a,{p:4,children:[Object(L.jsxs)(b.a,{variant:"h4",gutterBottom:!0,children:["Preview: ",e.name]}),Object(L.jsxs)(j.a,{component:"form",display:"flex",flexDirection:"column",gap:3,onSubmit:t=>{t.preventDefault(),p(!0);const c={};null===e||void 0===e||e.fields.forEach(e=>{if(!e.derived){const t=A(e,a[e.id]);t&&(c[e.id]=t)}}),n(c);let l=!0,r="";null===e||void 0===e||e.fields.forEach(e=>{const t=a[e.id];if("radio"!==e.type&&"select"!==e.type||!e.validation.correctAnswer||t!==e.validation.correctAnswer&&(l=!1,r+="".concat(e.label,": Incorrect answer.\n")),"checkbox"===e.type&&Array.isArray(e.validation.correctAnswers)){const a=Array.isArray(t)?t:[],c=e.validation.correctAnswers;a.length===c.length&&c.every(e=>a.includes(e))||(l=!1,r+="".concat(e.label,": Incorrect answer.\n"))}}),f(l?"All answers are correct!":r||"Some answers are incorrect."),0===Object.keys(c).length&&(console.log("Form Values:",a),alert("Form submitted successfully (check console for values)!"))},children:[e.fields.map(e=>{var t,c,l,n,i;const s=null!==(t=a[e.id])&&void 0!==t?t:"checkbox"===e.type?[]:"",o=null!==(c=r[e.id])&&void 0!==c?c:"",m=e.derived||!1;switch(e.type){case"text":case"number":case"date":return Object(L.jsx)(d.a,{type:e.type,label:"".concat(e.label).concat(m?" (Auto-calculated)":""),value:s,onChange:t=>F(e.id,t.target.value),error:!!o,helperText:o||(m?"This field is automatically calculated":""),disabled:m,sx:m?{"& .MuiInputBase-input":{color:"text.secondary"}}:{}},e.id);case"textarea":return Object(L.jsx)(d.a,{label:"".concat(e.label).concat(m?" (Auto-calculated)":""),value:s,onChange:t=>F(e.id,t.target.value),error:!!o,helperText:o||(m?"This field is automatically calculated":""),multiline:!0,rows:3,disabled:m,sx:m?{"& .MuiInputBase-input":{color:"text.secondary"}}:{}},e.id);case"select":return Object(L.jsxs)(j.a,{children:[Object(L.jsxs)(b.a,{children:[e.label,m?" (Auto-calculated)":""]}),Object(L.jsx)(u.a,{fullWidth:!0,value:s,onChange:t=>F(e.id,t.target.value),disabled:m,sx:m?{color:"text.secondary"}:{},children:null===(l=e.options)||void 0===l?void 0:l.map((e,t)=>Object(L.jsx)(h.a,{value:e,children:e},t))}),o&&Object(L.jsx)(T.a,{error:!0,children:o}),m&&Object(L.jsx)(T.a,{children:"This field is automatically calculated"})]},e.id);case"radio":return Object(L.jsxs)(j.a,{children:[Object(L.jsxs)(b.a,{children:[e.label,m?" (Auto-calculated)":""]}),Object(L.jsx)(B.a,{value:s,onChange:t=>F(e.id,t.target.value),children:null===(n=e.options)||void 0===n?void 0:n.map((e,t)=>Object(L.jsx)(O.a,{value:e,control:Object(L.jsx)(x.a,{disabled:m}),label:e,sx:m?{color:"text.secondary"}:{}},t))}),o&&Object(L.jsx)(T.a,{error:!0,children:o}),m&&Object(L.jsx)(T.a,{children:"This field is automatically calculated"})]},e.id);case"checkbox":return Object(L.jsxs)(j.a,{children:[Object(L.jsxs)(b.a,{children:[e.label,m?" (Auto-calculated)":""]}),null===(i=e.options)||void 0===i?void 0:i.map((t,a)=>Object(L.jsx)(O.a,{control:Object(L.jsx)(v.a,{checked:Array.isArray(s)&&s.includes(t),onChange:a=>{if(!m){const c=a.target.checked,l=Array.isArray(s)?s:[],r=c?[...l,t]:l.filter(e=>e!==t);F(e.id,r)}},disabled:m}),label:t,sx:m?{color:"text.secondary"}:{}},a)),o&&Object(L.jsx)(T.a,{error:!0,children:o}),m&&Object(L.jsx)(T.a,{children:"This field is automatically calculated"})]},e.id);default:return null}}),Object(L.jsx)(m.a,{variant:"contained",type:"submit",size:"large",children:"Submit"})]}),i&&g&&Object(L.jsx)(j.a,{mt:2,children:Object(L.jsx)(y.a,{severity:"All answers are correct!"===g?"success":"error",children:g})})]}):Object(L.jsx)(b.a,{children:"Loading form..."})},W=a(210),z=a(211);var P=()=>{const[e,t]=Object(c.useState)([]),a=Object(s.g)();Object(c.useEffect)(()=>{const e=Object.keys(localStorage).filter(e=>e.startsWith("form_")).map(e=>{const t=localStorage.getItem(e);if(!t)return null;try{return{key:e,data:JSON.parse(t)}}catch(a){return console.error("Error parsing form ".concat(e,":"),a),null}}).filter(Boolean);t(e)},[]);return Object(L.jsxs)(j.a,{p:4,children:[Object(L.jsx)(b.a,{variant:"h4",gutterBottom:!0,children:"Saved Forms"}),Object(L.jsxs)(p.a,{children:[e.map(e=>{let{key:t,data:c}=e;return Object(L.jsxs)(l.a.Fragment,{children:[Object(L.jsx)(W.a,{onClick:()=>(e=>{a.push("/preview-form/".concat(encodeURIComponent(e)))})(t),children:Object(L.jsx)(z.a,{primary:c.name,secondary:"Created: ".concat(new Date(c.createdAt).toLocaleString())})}),Object(L.jsx)(k.a,{})]},t)}),0===e.length&&Object(L.jsx)(b.a,{children:"No saved forms found."})]})]})};var V=()=>Object(L.jsx)(i.a,{children:Object(L.jsxs)(s.d,{children:[Object(L.jsx)(s.b,{path:"/create-form",component:E}),Object(L.jsx)(s.b,{path:"/preview-form/:formId",component:N}),Object(L.jsx)(s.b,{path:"/my-forms",component:P}),Object(L.jsx)(s.a,{from:"/",to:"/create-form",exact:!0})]})});n.a.render(Object(L.jsx)(l.a.StrictMode,{children:Object(L.jsx)(V,{})}),document.getElementById("root"))}},[[144,1,2]]]);
//# sourceMappingURL=main.b4192ea9.chunk.js.map